!function(t){"use strict";function e(t,e,i,o){return new(i||(i=Promise))((function(n,r){function a(t){try{l(o.next(t))}catch(t){r(t)}}function s(t){try{l(o.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((o=o.apply(t,e||[])).next())}))}const i="blitz68b173";const o=()=>!("undefined"==typeof window||!window._blitz),n=()=>!!o()&&window._blitz.isUser,r=t=>[...t].map(((t,e)=>(t.codePointAt()^i.charCodeAt(e%i.length)%255).toString(16).padStart(2,"0"))).join(""),a=t=>String.fromCharCode(...t.match(/.{1,2}/g).map(((t,e)=>parseInt(t,16)^i.charCodeAt(e%i.length)%255))),s=t=>{const e=localStorage.getItem("_bz_data");if(!e)return!0;const i=JSON.parse(a(e));for(const e in t){if(i[e]!==t[e])return!0}return!1};function l(t){const e=localStorage.getItem("_bz_auth_key")?localStorage.getItem("_bz_auth_key"):"",i=window&&window._blitz&&window._blitz.appKey?window._blitz.appKey:"";if(i&&i.includes("aqug39"))return;const o={method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8","auth-token":e},stringify:!0},n=Object.assign({},o,t);return new Promise(((i,o)=>{e||"POST"!==t.method||t.url.endsWith("user")||o(new Error("Blitz token: api call failed"));const r=new XMLHttpRequest;r.open(n.method,n.url),n.headers&&Object.keys(n.headers).forEach((t=>{r.setRequestHeader(t,n.headers[t])})),r.onload=()=>{var t;(t=r.status)>=200&&t<300||304===t?i({data:r.response?JSON.parse(r.response):{},status:r.statusText}):o(new Error("Blitz: api call failed"))},r.onerror=()=>o(new Error("Blitz1: api call failed")),r.send("POST"!==n.method&&"PUT"!==n.method||!n.stringify?n.body:JSON.stringify(n.body))}))}const d="https://gameplay.blitzllama.com/api/v1",c=(t,e,i)=>(e=e.trim(),e=u(e),"matches"===t?i.includes(e):"exactly"===t?i===e:"not_exactly"===t?i!==e:"starts"===t?i.startsWith(e):"ends"===t?i.endsWith(e):"not_matches"===t?!i.includes(e):("regrex"===t||"regex"===t)&&new RegExp(e).test(i)),u=t=>(t.includes("https://www.")?t=t.replace("https://www.",""):t.includes("https://")?t=t.replace("https://",""):t.includes("http://www.")?t=t.replace("http://www.",""):t.includes("http://")&&(t=t.replace("http://","")),t),w=t=>e(void 0,void 0,void 0,(function*(){if(!o()||!t||window._blitz.has_survey)return;const i=u(window.location.href),n=window._blitz.triggers;if("_page"===t){const t=n.find((t=>t.url_pattern&&t.pattern_type&&t.action&&"view"===t.action&&c(t.pattern_type,t.url_pattern,i)));if(t){const{trigger_name:i}=t;setTimeout((()=>e(void 0,void 0,void 0,(function*(){window._blitz&&!window._blitz.has_survey&&(window._blitz.has_survey=!0,yield _(i))}))),100)}}else{const e=n.find((e=>e.url_pattern&&e.action&&e.pattern_type&&e.css_selector===t&&"click"===e.action&&c(e.pattern_type,e.url_pattern,i)));if(e){const{trigger_name:t}=e;window._blitz&&!window._blitz.has_survey&&(window._blitz.has_survey=!0,yield _(t))}}}));const _=(t,i="",o=!1)=>e(void 0,void 0,void 0,(function*(){if(!t||p(!1))return;const e=window._blitz.lang?window._blitz.lang:"",n=window._blitz.theme?window._blitz.theme:"";if(!(window&&window._blitz&&window._blitz.triggers?window._blitz.triggers:[]).find((e=>e.trigger_name===t)))return;const r=yield((t,e,i,o="")=>{localStorage.setItem("_bz_trigger_queue",JSON.stringify({trigger:t,t:new Date}));const n=o?encodeURIComponent(JSON.stringify(o)):"";return l({method:"GET",url:`${d}/survey/web/trigger/${t}?lang_code=${e}&theme=${i}&properties=${n}`,stringify:!1})})(t,e,n,i),{data:a}=r;if(a&&a.data){const{survey:e}=a.data;if(e&&e.close_on_page_load&&o)return void localStorage.removeItem("_bz_trigger_queue");window._blitz.has_survey=!0;let i=0;a.data.trigger_name=t;const n=document.createElement("div");n.id="_blitz-container";const r=document.createElement("iframe");if(r.id="_blitz-frame",r.src="https://cdn.blitzllama.com/js/index.html",r.style.position="fixed",r.style.bottom="2px",r.style.right="2px",r.style.border="0px",r.style.zIndex="2147483647",r.style.width="397px",r.style.maxHeight="75vh",r.style.minHeight="150px",r.onload=()=>function(t){const e=document.getElementById("_blitz-frame");e&&e.contentWindow&&(setTimeout((()=>{var i;null===(i=e.contentWindow)||void 0===i||i.postMessage({type:"survey",info:t},"*")}),500),setTimeout((()=>{const e=document.getElementById("_blitz-container");e&&t&&t.survey&&"center"===t.survey.frame_position&&(e.style.backgroundColor="rgba(0, 0, 0, 0.6)")}),500))}(a.data),e&&e.close_on_page_load){window._blitz.close_path=!0,window._blitz.path||(window._blitz.path=[]);const e=window._blitz.path;e.push({t:t,u:window.location.href}),window._blitz.path=e}/mobile|tablet|android/i.test(navigator.userAgent.toLowerCase())&&window.screen.availWidth<=768?(r.style.left="0px",r.style.bottom="0px",r.style.right="0px",r.style.width="100vw"):("bottomleft"===e.frame_position&&(r.style.right="unset",r.style.left="2px"),"center"===e.frame_position&&(r.style.left="50%",r.style.top="50%",r.style.width="730px",r.style.maxHeight="80vh",r.style.minHeight="300px",r.style.transform="translate(-50%, -50%)",n.style.position="fixed",n.style.overflow="auto",n.style.top="0px",n.style.left="0px",n.style.display="flex",n.style.height="100%",n.style.width="100%",n.style.zIndex="2147483646",n.style.margin="auto")),e.trigger_delay&&(i=e.trigger_delay),n.appendChild(r),setTimeout((()=>{p(!0,t)||document.body.appendChild(n)}),1e3*i)}else window._blitz.has_survey=!1})),g=()=>{const t=document.getElementById("_blitz-container");t&&document.body.removeChild(t),window._blitz.has_survey=!1},p=(t,e="")=>{if(document.getElementById("_blitz-container"))return!0;if(!t)return!1;if(window._blitz.close_path){if(!window._blitz.path||0===window._blitz.path.length)return!0;if(!window._blitz.path.some((t=>t.t===e&&t.u===window.location.href)))return!0}return!1},b=t=>{try{document.createDocumentFragment().querySelector(t)}catch(t){return!1}return!0},y=t=>{for(const e in t){const{action:i,css_selector:o}=t[e];if(i&&o&&"click"===i&&b(o)){const t=document.querySelectorAll(o);for(let e=0;e<t.length;e++)t[e].addEventListener("click",(()=>{w(o)}))}}},h=()=>{if(!o())return;const t=window._blitz.triggers;t&&0!==t.length&&(m(),y(t))},m=()=>{if(!o())return;const t=window._blitz.triggers;if(t&&0!==t.length)for(const e in t){const{action:i,css_selector:o}=t[e];if(i&&o&&"click"===i){const t=document.querySelectorAll(o);for(let e=0;e<t.length;e++)t[e].removeEventListener("click",(t=>{t.preventDefault()}))}}},f=(t,i,c)=>e(void 0,void 0,void 0,(function*(){if(!o()||!n())return;if(!s({[t]:i}))return;const e=yield((t,e,i)=>l({method:"PUT",url:`${d}/user/attribute`,body:{filter:t,filter_value:e,data_type:i}}))(t,i,c);if(e&&e.data&&e.data.data){const e=localStorage.getItem("_bz_data"),o=e?JSON.parse(a(e)):{};localStorage.setItem("_bz_data",r(JSON.stringify(Object.assign(Object.assign({},o),{[t]:i}))))}})),v=t=>e(void 0,void 0,void 0,(function*(){if(!o()||!n())return;if(!s(t))return;const e=yield(t=>l({method:"PUT",url:`${d}/user/attributes`,body:{properties:t}}))(t);if(e&&e.data&&e.data.data){const e=localStorage.getItem("_bz_data"),i=e?JSON.parse(a(e)):{};localStorage.setItem("_bz_data",r(JSON.stringify(Object.assign(Object.assign({},i),t))))}})),z=t=>e(void 0,void 0,void 0,(function*(){o()&&n()&&l({method:"PUT",url:`${d}/user/name`,body:{user_name:t},stringify:!0})})),S=t=>e(void 0,void 0,void 0,(function*(){o()&&n()&&l({method:"PUT",url:`${d}/user/email`,body:{user_email:t}})})),I=t=>e(void 0,void 0,void 0,(function*(){if(window._blitz.state="paused",!o()||!t)return void(window._blitz.state="loaded");if(localStorage.getItem("_bz_user"))return window._blitz.isUser=!0,void(window._blitz.state="completed");const e=window._blitz.appKey,i=yield((t,e)=>l({method:"POST",url:`${d}/survey/web/user`,body:{app_key:t,user_id:e}}))(e,t),{data:n}=i;if(n&&n.data){const{auth_token:t}=n.data;t&&(localStorage.setItem("_bz_auth_key",t),localStorage.setItem("_bz_user","t"),window._blitz.isUser=!0)}window._blitz.state="completed",window._blitzQueue&&window._blitzQueue.length>0&&(yield T())})),k=()=>{localStorage.removeItem("_bz_auth_key"),localStorage.removeItem("_bz_user"),m()},x=t=>e(void 0,void 0,void 0,(function*(){if(!t||!window)return;if(window._blitz&&window._blitz.appKey)return;window._blitz={state:"loaded",isUser:!1,logout:k,close_path:!1,registered:!1,dismissSurvey:g},!function(t){const e=RegExp("[?&]"+t+"=([^&]*)").exec(window.location.search);return e&&decodeURIComponent(e[1].replace(/\+/g," "))}("debug")?window._blitz.debug=!1:window._blitz.debug=!0,window._blitz.appKey=t;const i=yield(t=>{const e=(new Date).toISOString().split("T")[0],i=localStorage.getItem("_bz_view_at"),o=i===e?1:0;return i!==e&&localStorage.setItem("_bz_view_at",e),l({method:"GET",url:`${d}/survey/web/${t}/triggers?t=${o}`,stringify:!1})})(t),{data:o}=i;if(o&&o.data){const{triggers:i=[],token:n,all_triggers:r=[],trigger_with_events:a=[]}=o.data;window._blitz.triggers=i,window._blitz.all_triggers=r,window._blitz.trigger_with_events=a,window._blitz.state="active",n&&localStorage.getItem("_bz_auth_key")&&(yield(t=>{const e=(new Date).toISOString().split("T")[0],i=localStorage.getItem("_bz_view_at");if(!i||i!==e)return localStorage.setItem("_bz_view_at",e),l({method:"POST",url:`${d}/survey/web/${t}/app-open`})})(t)),n&&!localStorage.getItem("_bz_auth_key")&&localStorage.setItem("_bz_auth_key",n);const s=localStorage.getItem("_bz_trigger_queue");if(s){const t=JSON.parse(s);if(t&&t.t){((new Date).getTime()-new Date(t.t).getTime())/1e3<=10&&setTimeout((()=>e(void 0,void 0,void 0,(function*(){yield _(t.trigger,"",!0)}))),1e3)}localStorage.removeItem("_bz_trigger_queue")}if(i&&i.length>0){y(i);const t=i.some((t=>"view"===t.action)),o=i.some((t=>"click"===t.action));if(t){setTimeout((()=>e(void 0,void 0,void 0,(function*(){w("_page")}))),500),window.addEventListener("load",(()=>{w("_page")}));if(window.location.href.includes("/#/"))window.addEventListener("hashchange",(()=>w("_page")));else{const t=history.pushState;history.pushState=function(){t.apply(history,arguments),w("_page")};const e=history.replaceState;history.replaceState=function(){e.apply(history,arguments),w("_page")}}}o&&window.addEventListener("click",(()=>{h()}))}}}));const E=(t,i,r,a)=>e(void 0,void 0,void 0,(function*(){if("logout"===t||t&&i)switch(t){case"init":yield x(i);break;case"createUser":yield I(i);break;case"setUserName":yield z(i);break;case"setUserEmail":yield S(i);break;case"setUserAttribute":r&&a&&(yield f(i,r,a));break;case"setUserProperties":v(i);break;case"setSurveyLanguage":d=i,o()&&n()&&(window._blitz.lang=d);break;case"setSurveyTheme":l=i,o()&&n()&&(window._blitz.theme=l);break;case"triggerEvent":yield _(i,r);break;case"subscribeEvent":e=i,s=r,window._blitz.registered||document.addEventListener(e,s),window._blitz.registered=!0;break;case"logout":k();break;default:return}var e,s,l,d}));function T(){return e(this,void 0,void 0,(function*(){if(window&&window._blitzQueue&&window._blitzQueue.length>0){const t=window._blitzQueue.length;for(let e=0;e<t;e++){const t=window._blitzQueue[0];if(t&&("init"===t[0]||"createUser"===t[0])||window._blitz&&"paused"!==window._blitz.state){const t=window._blitzQueue.shift();if(t&&t.length>=1){const e=t[0],i=t[1],o=t[2],n=t[3];yield E(e,i,o,n)}}}}}))}var O;O=()=>e(void 0,void 0,void 0,(function*(){if(window._blitzQueue&&"Array"===window._blitzQueue.constructor.name)if(Object.defineProperty(window._blitzQueue,"push",{configurable:!0,enumerable:!1,writable:!0,value:function(...t){const e=Array.prototype.push.apply(this,t);return T(),e}}),yield T(),yield h(),window.addEventListener("message",(({data:t})=>{if(!t||!t.type)return;const{info:e,type:i}=t;"dismiss"===i&&g(),"dimensions"===i&&(localStorage.removeItem("_bz_trigger_queue"),(t=>{const e=document.getElementById("_blitz-frame");e&&(e.style.height=`${t+5}px`)})(e.height)),"survey_complete_callback"===i&&((t,e)=>{e&&document.dispatchEvent(new CustomEvent(t,{detail:e})),window._blitz.registered=!1})("survey_completed",e)})),window.location.href.includes("/#/"))window.addEventListener("hashchange",(function(){window._blitz&&window._blitz.close_path&&(window._blitz.path=[],g()),setTimeout((()=>e(this,void 0,void 0,(function*(){yield h()}))),300)}));else{const t=history.pushState;history.pushState=function(){t.apply(history,arguments),window._blitz&&window._blitz.close_path&&(window._blitz.path=[],g()),setTimeout((()=>e(this,void 0,void 0,(function*(){yield h()}))),300)};const i=history.replaceState;history.replaceState=function(){i.apply(history,arguments),window._blitz&&window._blitz.close_path&&(window._blitz.path=[],g()),setTimeout((()=>e(this,void 0,void 0,(function*(){yield h()}))),300)}}})),document&&("complete"===document.readyState?O():document.onreadystatechange=function(){"complete"===document.readyState&&O()}),t.default=function(){return{init:x}},Object.defineProperty(t,"__esModule",{value:!0})}({});